webpackJsonp([9],{E0NG:function(t,s){},"V+e6":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("JJSs"),a=e("HwgM"),n=e("wqlu"),l=e("8Jho"),o=e("mzkE"),c=e("qK+J"),r=e.n(c),u=e("lCmq"),d=e("bUp0"),m=e("3/Li"),v=e("zL8q"),h={name:"cookBook",components:{RightView:a.a,FoodItem:n.a,headerNav:i.a,FooterBottom:o.a,InfiniteLoading:r.a,Totop:l.a},data:function(){return{num:13,page:1,page2:0,sortList:"",menuDetail:"",foodList:[],commentList:[],beuserid:0,message:"",replyid:0,replyuserid:0,commentid:0,message1:"",message2:"",token:"",cpid:"",dialogVisible:!1,mainMenuList:[],loadMore:!0,replyShow:!1,reply2Show:!1,input_placeholder:"来了说两句吧~",is_reply:!1,osshost:"https://guanfan.oss-cn-hangzhou.aliyuncs.com/",listpic:"?x-oss-process=style/list-img",userface:"?x-oss-process=style/user-img",detailpic:"?x-oss-process=style/detail-img"}},created:function(){this.token=this.$store.state.user.token||"",this.cpid=this.$route.query.id,this.getDataInfo(this.cpid),this.getCommentList()},methods:{navToIndex:function(t){this.$router.push({path:"/user",query:{id:t}})},getDataInfo:function(t){var s=this;Object(d.b)(t).then(function(t){var e=t.data;if(e.success){s.menuDetail=e.result,s.foodList=s.menuDetail.stuff.split("|");for(var i=0;i<s.foodList.length;i++){var a;a=s.foodList[i].split("#"),s.foodList[i]={name:a[0],num:a[1]}}}else Object(v.Message)({message:t.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)})},loadMorep:function(){this.page++,this.getCommentList()},getCommentList:function(){var t=this;Object(m.b)(this.cpid,2,this.page).then(function(s){var e=s.data;e.success?0!=e.result.length?t.commentList=t.commentList.concat(e.result):t.loadMore=!1:Object(v.Message)({message:s.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)})},comment:function(t,s){""==this.token?navigateTo("../login/pswLogin"):(this.replyShow=!0,this.beuserid=t,this.commentid=s)},reply:function(t,s,e,i){this.is_reply=!0,this.replyShow=!0;var a=i;this.input_placeholder="回复"+a,this.replyid=0,this.replyuserid=0,this.beuserid=s,this.commentid=e,console.log(this.commentid,this.beuserid)},reply2:function(t,s,e,i,a){this.is_reply=!0,this.replyShow=!0;var n=a;this.input_placeholder="回复"+n,this.replyid=t,this.beuserid=s,this.replyuserid=e,this.commentid=i},postComment:function(){var t=this;if(""==this.token)this.$router.push({path:"/login"});else{this.message;var s={itemid:this.cpid,itemtype:2,replyid:this.replyid,replyuserid:this.replyuserid,commentid:this.commentid,beuserid:this.beuserid,message:this.message};Object(m.e)(s).then(function(s){var e=s.data;e.success?(Object(v.Message)({message:e.message,duration:5e3}),document.getElementById("reply").scrollIntoView(),t.page=0,t.commentList=[],t.getCommentList(),t.is_reply=!1,t.replyShow=!1):(Object(v.Message)({message:e.message,type:"error",duration:5e3}),"9999"==e.code&&t.$router.push({path:"/login"}))}).catch(function(t){console.log(t)})}},collectMenu:function(){var t=this;this.token?this.menuDetail.iscollectioned?Object(m.f)(this.cpid,2).then(function(s){s.data.success?t.menuDetail.iscollectioned=!1:Object(v.Message)({message:s.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)}):Object(m.a)(this.cpid,2).then(function(s){s.data.success?t.menuDetail.iscollectioned=!0:Object(v.Message)({message:s.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)}):this.$router.push({path:"/login"})},attentionUser:function(t){var s=this;this.token?Object(m.c)(t).then(function(t){t.data.success?0==s.menuDetail.relationship?s.menuDetail.relationship=1:2==s.menuDetail.relationship&&(s.menuDetail.relationship=3):Object(v.Message)({message:t.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)}):this.$router.push({path:"/login"})},unAttentionUser:function(t){var s=this;this.token?Object(m.g)(t).then(function(t){t.data.success?1==s.menuDetail.relationship?s.menuDetail.relationship=0:3==s.menuDetail.relationship&&(s.menuDetail.relationship=2):Object(v.Message)({message:t.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)}):this.$router.push({path:"/login"})},infiniteHandler:function(t){this.page2++,this.getDtList(t)},getDtList:function(t){var s=this;Object(u.f)(this.cpid,this.page2).then(function(e){var i=e.data;if(i.success)if(0!==i.result.length){s.mainMenuList=s.mainMenuList.concat(i.result);for(var a=0;a<s.mainMenuList.length;a++)s.mainMenuList[a].dtimg=s.mainMenuList[a].dtimg.split("|"),s.mainMenuList[a].dtimg=s.mainMenuList[a].dtimg[0];0!=s.page2&&t.loaded()}else t.complete();else Object(v.Message)({message:e.message,type:"error",duration:5e3})}).catch(function(t){console.log(t)})},navToDetail:function(t){this.$router.push({path:"/dtDetail",query:{id:t}})}}},p={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{attrs:{id:"header"}},[e("header-nav")],1),t._v(" "),e("div",{staticClass:"content mt30 clearfix padding-top-60",attrs:{id:"content"}},[e("div",{staticClass:"mr30 mt30 mb30",attrs:{id:"left"}},[e("div",{staticClass:"bg-img mainImg br5",style:{backgroundImage:"url("+t.osshost+t.menuDetail.cpimg+t.detailpic+")"}}),t._v(" "),e("div",{staticClass:"menu_info mt10"},[e("div",{staticClass:"name"},[t._v(t._s(t.menuDetail.title))]),t._v(" "),e("div",{staticClass:"info clearfix"},[e("div",{staticClass:"mainColor left"}),t._v(" "),e("div",{staticClass:"grayColor"},[e("span",{staticClass:"mr10"},[e("i",{staticClass:"iconfont grayColor"},[t._v(" ")]),t._v(t._s(t.menuDetail.collections))]),t._v(" "),e("span",[e("i",{staticClass:"iconfont mr10 grayColor"},[t._v("")]),t._v(t._s(t.menuDetail.visits))]),t._v(" "),e("div",{staticClass:"btn-sc",on:{click:function(s){return t.collectMenu()}}},[t.menuDetail.iscollectioned?e("el-button",{staticClass:"el-icon-close",attrs:{size:"small",round:""}},[t._v("取消收藏")]):e("el-button",{staticClass:"el-icon-plus",attrs:{size:"small",type:"warning",round:""}},[t._v("收藏菜谱")])],1)])])]),t._v(" "),e("div",[e("ul",{staticClass:"dr_list dr_list2"},[e("li",{staticClass:"clearfix mb15"},[e("div",{staticClass:"left headicon bg-img br50",style:{backgroundImage:"url("+t.osshost+t.menuDetail.faceimg+t.userface+")"},on:{click:function(s){return t.navToIndex(t.menuDetail.userid)}}}),t._v(" "),e("div",{staticClass:"info"},[e("h2",{staticClass:"text-bold text-df"},[t._v(t._s(t.menuDetail.nickname))])]),t._v(" "),0==t.menuDetail.relationship||2==t.menuDetail.relationship?e("a",{staticClass:"right",on:{click:function(s){return t.attentionUser(t.menuDetail.userid)}}},[e("el-button",{staticClass:"el-icon-plus",attrs:{size:"small",type:"warning",round:""}},[t._v("关注")])],1):e("a",{staticClass:"right",on:{click:function(s){return t.unAttentionUser(t.menuDetail.userid)}}},[e("el-button",{staticClass:"el-icon-close",attrs:{size:"small",round:""}},[t._v("取消关注")])],1)])]),t._v(" "),e("div",{staticClass:"text-df"},[t._v(t._s(t.menuDetail.story))])]),t._v(" "),e("div",{staticClass:"mt50"},[e("h1",[t._v("食材配料")]),t._v(" "),e("div",{staticClass:"grid col-2 border mt15"},t._l(t.foodList,function(s,i){return e("div",{key:i,staticClass:"clearfix text-df"},[e("span",{staticClass:"left text-bold"},[t._v(t._s(s.name))]),t._v(" "),e("span",{staticClass:"right"},[t._v(t._s(s.num))])])}),0)]),t._v(" "),e("div",{staticClass:"mt50"},[e("h1",[t._v("制作步骤")]),t._v(" "),t._l(t.menuDetail.step,function(s,i){return e("div",{key:i,staticClass:"mt15"},[e("div",{staticClass:"mainColor height-30"},[e("span",{staticClass:"text-df textTop"},[t._v("步骤")]),e("span",{staticClass:"text-xsl"},[t._v(t._s(s.sort))])]),t._v(" "),e("div",{staticClass:"clearfix mt15"},[""!=s.stepImg?e("div",{staticClass:"left"},[e("div",{staticClass:"bg-img cover xxl br5",style:{backgroundImage:"url("+t.osshost+s.stepImg+t.listpic+")"}})]):t._e(),t._v(" "),e("div",{staticClass:"left ml15 text-df",staticStyle:{width:"365px"}},[t._v("\n              "+t._s(s.description)+"\n            ")])])])})],2),t._v(" "),e("div",{staticClass:"mt50"},[t._m(0),t._v(" "),e("div",{staticClass:"text-df mt20"},[e("p",{staticClass:"mb35"},[t._v(t._s(t.menuDetail.tip))]),t._v(" "),e("p",{staticClass:"grayColor"},[t._v("创建时间："+t._s(t.menuDetail.pushtime))]),t._v(" "),e("p",[t._v("本菜谱的做法由"),e("span",{staticClass:"mainColor"},[t._v(t._s(t.menuDetail.nickname))]),t._v("编写，未经授权不得转载")])])]),t._v(" "),e("div",{staticClass:"mt45"},[e("h1",[t._v("大家的学习成果\n          "),e("div",{staticClass:"more",on:{click:function(s){t.dialogVisible=!0}}},[t._v("更多"+t._s(t.menuDetail.shows.length)),e("i",{staticClass:"iconfont mainColor"},[t._v("")])])]),t._v(" "),e("ul",{staticClass:"like-list2 like-list5 clearfix"},t._l(t.menuDetail.shows.slice(0,4),function(s,i){return e("li",{key:i,staticClass:"item",on:{click:function(e){return t.navToDetail(s.id)}}},[e("div",{staticClass:"cover br5 bg-img",style:{backgroundImage:"url("+t.osshost+s.dtimg+t.listpic+")"}}),t._v(" "),e("div",[e("div",{staticClass:"name text-tips"},[t._v(t._s(s.description))]),t._v(" "),e("div",{staticClass:"author"},[e("img",{staticClass:"headicon br50",attrs:{src:t.osshost+s.faceimg+t.userface}}),t._v(" "),e("span",{staticClass:"nickname text-lips",staticStyle:{"max-width":"238px"}},[t._v(t._s(s.nickname))])])])])}),0),t._v(" "),e("div",{staticClass:"text-center mt30"},[e("router-link",{attrs:{to:{path:"/publishDt?cpid="+t.cpid}}},[e("button",{staticClass:"cu-btn bg-yellow br5"},[t._v("上传我的作品")])])],1)]),t._v(" "),e("div",{},[e("p",{staticClass:"fcc text-lips"},[t._v("您当前的位置："),e("a",{attrs:{href:"/",title:""}},[t._v("首页")]),t._v(" \\ "+t._s(t.menuDetail.title))])]),t._v(" "),e("div",{staticClass:"mt50"},[e("h1",{attrs:{id:"reply"}},[t._v("评论"),e("el-button",{staticClass:"right",attrs:{type:"warning"},on:{click:function(s){return t.comment(0,0)}}},[t._v("发表评论")])],1),t._v(" "),e("div",{staticClass:"mt30"},[e("el-dialog",{attrs:{title:"评论回复",visible:t.replyShow,width:"600px","before-close":t.handleClose},on:{"update:visible":function(s){t.replyShow=s}}},[e("form",{staticClass:"cu-form-group"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{placeholder:t.input_placeholder},domProps:{value:t.message},on:{input:function(s){s.target.composing||(t.message=s.target.value)}}}),t._v(" "),e("div",{staticClass:"clearfix"},[e("button",{staticClass:"cu-btn sm bg-yellow right br5 mt10",on:{click:function(s){return t.postComment()}}},[t._v(" 发表评论\n                ")])])])]),t._v(" "),e("div",[e("div",[e("ul",{staticClass:"dr_list"},t._l(t.commentList,function(s,i){return e("li",{key:i,staticClass:"clearfix mb15"},[e("div",{staticClass:"left headicon bg-img br50",style:{backgroundImage:"url("+t.osshost+s.faceimg+t.userface+")"},on:{click:function(e){return t.navToIndex(s.userid)}}}),t._v(" "),e("div",{staticClass:"info",staticStyle:{width:"640px"}},[e("h4",{staticClass:"text-bold text-df"},[t._v(t._s(s.nickname)),s.userid==t.menuDetail.userid?e("span",{staticClass:"text-12 grayColor user-img-boder ml10"},[t._v("作者")]):t._e()]),t._v(" "),e("p",{staticClass:"grayColor"},[t._v(t._s(s.pushtime)+" "),e("span",{staticClass:"mainColor",on:{click:function(e){return t.reply(s.commentid,s.userid,s.id,s.nickname)}}},[t._v("回复")])]),t._v(" "),e("div",[e("p",{staticClass:"text-df text-height-lg"},[t._v(" "+t._s(s.message))])]),t._v(" "),e("ul",{staticClass:"dr_list"},t._l(s.subreplylist,function(i,a){return e("li",{key:a,staticClass:"clearfix mb15"},[e("div",{staticClass:"left headicon bg-img br50",style:{backgroundImage:"url("+t.osshost+i.faceimg+t.userface+")"},on:{click:function(s){return t.navToIndex(i.userid)}}}),t._v(" "),e("div",{staticClass:"info",staticStyle:{width:"440px"}},[e("h4",{staticClass:"text-bold text-df"},[t._v(t._s(i.nickname)),i.userid==t.menuDetail.userid?e("span",{staticClass:"text-12 grayColor user-img-boder ml10"},[t._v("作者")]):t._e()]),t._v(" "),e("p",{staticClass:"grayColor"},[t._v(t._s(i.pushtime)+" "),e("span",{staticClass:"mainColor",on:{click:function(e){return t.reply2(i.id,s.userid,i.userid,i.commentid,i.nickname)}}},[t._v("回复")])]),t._v(" "),e("div",[i.bereplynickname?e("p",{staticClass:"text-14 grayColor"},[t._v("回复:"+t._s(i.bereplynickname))]):t._e(),t._v(" "),e("p",{staticClass:"text-df text-height-lg"},[t._v(" "+t._s(i.message))])])])])}),0)])])}),0),t._v(" "),t.loadMore?e("div",{staticClass:"text-center mainColor mb15",on:{click:function(s){return t.loadMorep()}}},[t._v("点击加载更多")]):e("div",{staticClass:"text-center grayColor mb15"},[t._v("没有评论了")])])])],1)])]),t._v(" "),e("el-dialog",{attrs:{title:t.menuDetail.title+"相关作品",visible:t.dialogVisible,width:"1040px","before-close":t.handleClose},on:{"update:visible":function(s){t.dialogVisible=s}}},[e("ul",{staticClass:"like-list2 clearfix"},t._l(t.mainMenuList,function(s,i){return e("li",{key:i,staticClass:"item"},[e("div",{staticClass:"cover bg-img",style:{backgroundImage:"url("+t.osshost+s.dtimg+t.listpic+")"},on:{click:function(e){return t.navToDetail(s.id)}}}),t._v(" "),e("div",[e("div",[e("div",{staticClass:"name text-tips text-cut-two"},[t._v(t._s(s.description))]),t._v(" "),e("div",{staticClass:"author"},[e("img",{staticClass:"headicon br50",attrs:{src:t.osshost+s.faceimg+t.userface},on:{click:function(e){return t.navToIndex(s.userid)}}}),t._v(" "),e("span",{staticClass:"nickname text-lips",staticStyle:{"max-width":"238px"}},[t._v(t._s(s.nickname))]),t._v(" "),e("span",{staticClass:"right text-xm el-icon-lollipop margin-right-xs block"},[t._v(t._s(s.likecount))])])])])])}),0),t._v(" "),e("infinite-loading",{staticClass:"mt50 mb60",on:{infinite:t.infiniteHandler}},[e("div",{attrs:{slot:"spinner"},slot:"spinner"},[e("i",{staticClass:"el-icon-loading"}),t._v("小弟拼命加载中...")]),t._v("//加载中的文字\n        "),e("div",{staticClass:"el-icon-food grayColor",attrs:{slot:"no-more"},slot:"no-more"},[t._v("已加载完毕!")]),t._v("//加载完毕的文字\n        "),e("div",{staticClass:"el-icon-coffee-cup grayColor",attrs:{slot:"no-results"},slot:"no-results"},[t._v("暂无数据:(")]),t._v("//没有数据的文字\n      ")])],1),t._v(" "),e("div",{staticClass:"mt30",attrs:{id:"right"}},[t.menuDetail.userid?e("right-view",{attrs:{uid:t.menuDetail.userid}}):t._e()],1)],1),t._v(" "),e("FooterBottom"),t._v(" "),e("Totop")],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",[s("i",{staticClass:"iconfont mainColor text-xl mr10"},[this._v("")]),this._v("小贴士")])}]};var g=e("VU/8")(h,p,!1,function(t){e("E0NG")},"data-v-4d460010",null);s.default=g.exports}});
//# sourceMappingURL=9.621453f58143c92306e3.js.map